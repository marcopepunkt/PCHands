<!--
SPDX-FileCopyrightText: 2025 Humanoid Sensing and Perception, Istituto Italiano di Tecnologia
SPDX-License-Identifier: BSD-3-Clause
Code adapted from https://github.com/leap-hand/LEAP_Hand_Sim under CC BY‑NC‑SA
-->
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="leap_hand_right">
    <xacro:macro name="leap_model">
        <xacro:property name="yaml_file" value="../../adf/calib_eef.yaml" />
        <xacro:property name="calib_eef" value="${load_yaml(yaml_file)['leap_hand_right']}"/>
        <!--  palm frame  -->
        <link name="eef_link">
            <inertial>
                <origin rpy="0 0 0" xyz="0 0 0"/>
                <mass value="0.0001"/>
                <inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/>
            </inertial>
        </link>
        <joint name="r_eef_calib_joint" type="fixed">
            <parent link="eef_link"/>
            <child link="eef_calib_link"/>
            <origin xyz="${calib_eef['tx']} ${calib_eef['ty']} ${calib_eef['tz']}" 
                    rpy="${calib_eef['rx']} ${calib_eef['ry']} ${calib_eef['rz']}"/>
        </joint>
        <link name="eef_calib_link">
            <inertial>
                <origin rpy="0 0 0" xyz="0 0 0"/>
                <mass value="0.0001"/>
                <inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/>
            </inertial>
        </link>
        <joint name="r_eef_fixed_joint" type="fixed">
            <parent link="eef_calib_link"/>
            <child link="palm_base_link"/>
            <origin xyz="-0.023 -0.044 0.037" rpy="1.5708 0.0 -1.2708"/>
        </joint>
        <link name="palm_base_link">
            <visual>
                <geometry>
                    <mesh filename="mesh/r_palm.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/r_palm_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.237"/>
                <inertia ixx="0.000354094" ixy="-0.000001193" ixz="-0.000002445" iyy="0.000260915" iyz="-0.000002905" izz="0.000529257"/>
            </inertial>
        </link>
        <joint name="r_flange_fixed_joint" type="fixed">
            <parent link="palm_base_link"/>
            <child link="flange_link"/>
            <origin xyz="-0.0575 -0.0335 0.0113" rpy="-1.5708 0 1.5708"/>
        </joint>
		<link name="flange_link"/>

        <!--  thumb finger  -->
        <link name="r_thumb0">
            <visual>
                <geometry>
                    <mesh filename="mesh/thumb_base.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/thumb_base_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.032"/>
                <inertia ixx="0.000004798" ixy="0.000000012" ixz="0.000000004" iyy="0.000002862" iyz="0.000000011" izz="0.000004234"/>
            </inertial>
        </link>
        <link name="r_thumb1">
            <visual>
                <geometry>
                    <mesh filename="mesh/thumb_pip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/thumb_pip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.003"/>
                <inertia ixx="0.000000593" ixy="0" ixz="0" iyy="0.000000549" iyz="0" izz="0.000000224"/>
            </inertial>
        </link>
        <link name="r_thumb2">
            <visual>
                <geometry>
                    <mesh filename="mesh/thumb_dip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/thumb_dip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.038"/>
                <inertia ixx="0.000008474" ixy="0.000000241" ixz="0.000000026" iyy="0.000003841" iyz="0.000000025" izz="0.000007679"/>
            </inertial>
        </link>
        <link name="r_thumb3">
            <visual>
                <geometry>
                    <mesh filename="mesh/thumb_fingertip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/thumb_fingertip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.049"/>
                <inertia ixx="0.000020372" ixy="-0.000000489" ixz="-0.00000003" iyy="0.000004336" iyz="-0.000000097" izz="0.000019845"/>
            </inertial>
        </link>
        <joint name="r_00thumb0" type="revolute">
            <origin xyz="-0.069395 -0.001242 -0.02162" rpy="0 1.5708 0"/>
            <parent link="palm_base_link"/>
            <child link="r_thumb0"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.349" upper="2.094"/>
        </joint>
        <joint name="r_01thumb1" type="revolute">
            <origin xyz="0 0.0143 -0.013" rpy="1.570796 -1.570796 0"/>
            <parent link="r_thumb0"/>
            <child link="r_thumb1"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.47" upper="2.443"/>
        </joint>
        <joint name="r_02thumb2" type="revolute">
            <origin xyz="0 0.0145 -0.017" rpy="-1.570796 0 0"/>
            <parent link="r_thumb1"/>
            <child link="r_thumb2"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-1.20" upper="1.90"/>
        </joint>
        <joint name="r_03thumb3" type="revolute">
            <origin xyz="0 0.0466 0.0002" rpy="0 0 3.141592653589793116"/>
            <parent link="r_thumb2"/>
            <child link="r_thumb3"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-1.34" upper="1.88"/>
        </joint>

        <!--  index finger  -->
        <link name="r_index0">
            <visual>
                <geometry>
                    <mesh filename="mesh/mcp_joint.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/mcp_joint_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.044"/>
                <inertia ixx="0.000011499" ixy="0.000003049" ixz="0.000000121" iyy="0.000007796" iyz="0.000000112" izz="0.000014759"/>
            </inertial>
        </link>
        <link name="r_index1">
            <visual>
                <geometry>
                    <mesh filename="mesh/pip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/pip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.032"/>
                <inertia ixx="0.000004798" ixy="0.000000012" ixz="0.000000004" iyy="0.000002862" iyz="0.000000011" izz="0.000004234"/>
            </inertial>
        </link>
        <link name="r_index2">
            <visual>
                <geometry>
                    <mesh filename="mesh/dip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/dip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.037"/>
                <inertia ixx="0.000005542" ixy="-0.000000607" ixz="-0.000000017" iyy="0.000005727" iyz="-0.000000023" izz="0.000006682"/>
            </inertial>
        </link>
        <link name="r_index3">
            <visual>
                <geometry>
                    <mesh filename="mesh/fingertip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/fingertip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.016"/>
                <inertia ixx="0.000003368" ixy="0.000000115" ixz="0" iyy="0.000001556" iyz="0" izz="0.000002863"/>
            </inertial>
        </link>
        <joint name="r_04index0" type="revolute">
            <origin xyz="-0.0071 0.0230 -0.0187" rpy="1.5708 1.5708 0"/>
            <parent link="palm_base_link"/>
            <child link="r_index0"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.314" upper="2.23"/>
        </joint>
        <joint name="r_05index1" type="revolute">
            <origin xyz="-0.0122 0.0381 0.0145" rpy="-1.5708 0 1.5708"/>
            <parent link="r_index0"/>
            <child link="r_index1"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-1.047" upper="1.047"/>
        </joint>
        <joint name="r_06index2" type="revolute">
            <origin xyz="0.015 0.0143 -0.013" rpy="1.5708 -1.5708 0"/>
            <parent link="r_index1"/>
            <child link="r_index2"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.506" upper="1.885"/>
        </joint>
        <joint name="r_07index3" type="revolute">
            <origin xyz="0 -0.0361 0.0002" rpy="0 0 0"/>
            <parent link="r_index2"/>
            <child link="r_index3"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.366" upper="2.042"/>
        </joint>

        <!--  middle finger  -->
        <link name="r_middle0">
            <visual>
                <geometry>
                    <mesh filename="mesh/mcp_joint.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/mcp_joint_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.044"/>
                <inertia ixx="0.000011499" ixy="0.000003049" ixz="0.000000121" iyy="0.000007796" iyz="0.000000112" izz="0.000014759"/>
            </inertial>
        </link>
        <link name="r_middle1">
            <visual>
                <geometry>
                    <mesh filename="mesh/pip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/pip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.032"/>
                <inertia ixx="0.000004798" ixy="0.000000012" ixz="0.000000004" iyy="0.000002862" iyz="0.000000011" izz="0.000004234"/>
            </inertial>
        </link>
        <link name="r_middle2">
            <visual>
                <geometry>
                    <mesh filename="mesh/dip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/dip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.037"/>
                <inertia ixx="0.000005542" ixy="-0.000000607" ixz="-0.000000017" iyy="0.000005727" iyz="-0.000000023" izz="0.000006682"/>
            </inertial>
        </link>
        <link name="r_middle3">
            <visual>
                <geometry>
                    <mesh filename="mesh/fingertip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/fingertip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.016"/>
                <inertia ixx="0.000003368" ixy="0.000000115" ixz="0" iyy="0.000001556" iyz="0" izz="0.000002863"/>
            </inertial>
        </link>
        <joint name="r_08middle0" type="revolute">
            <origin xyz="-0.0071 -0.0224 -0.0187" rpy="1.5708 1.5708 0"/>
            <parent link="palm_base_link"/>
            <child link="r_middle0"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.314" upper="2.23"/>
        </joint>
        <joint name="r_09middle1" type="revolute">
            <origin xyz="-0.0122 0.0381 0.0145" rpy="-1.5708558 0 1.5708"/>
            <parent link="r_middle0"/>
            <child link="r_middle1"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-1.047" upper="1.047"/>
        </joint>
        <joint name="r_10middle2" type="revolute">
            <origin xyz="0.015 0.0143 -0.013" rpy="1.5708 -1.5708 0"/>
            <parent link="r_middle1"/>
            <child link="r_middle2"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.506" upper="1.885"/>
        </joint>
        <joint name="r_11middle3" type="revolute">
            <origin xyz="0 -0.0361 0.0002" rpy="0 0 0"/>
            <parent link="r_middle2"/>
            <child link="r_middle3"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.366" upper="2.042"/>
        </joint>
        
        <!--  rinkie finger  -->
        <link name="r_rinkie0">
            <visual>
                <geometry>
                    <mesh filename="mesh/mcp_joint.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/mcp_joint_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.044"/>
                <inertia ixx="0.000011499" ixy="0.000003049" ixz="0.000000121" iyy="0.000007796" iyz="0.000000112" izz="0.000014759"/>
            </inertial>
        </link>
        <link name="r_rinkie1">
            <visual>
                <geometry>
                    <mesh filename="mesh/pip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/pip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.032"/>
                <inertia ixx="0.000004798" ixy="0.000000012" ixz="0.000000004" iyy="0.000002862" iyz="0.000000011" izz="0.000004234"/>
            </inertial>
        </link>
        <link name="r_rinkie2">
            <visual>
                <geometry>
                    <mesh filename="mesh/dip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/dip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.037"/>
                <inertia ixx="0.000005542" ixy="-0.000000607" ixz="-0.000000017" iyy="0.000005727" iyz="-0.000000023" izz="0.000006682"/>
            </inertial>
        </link>
        <link name="r_rinkie3">
            <visual>
                <geometry>
                    <mesh filename="mesh/fingertip.stl"/>
                </geometry>
            </visual>
            <collision>
                <geometry>
                    <mesh filename="mesh/fingertip_.stl"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="0.016"/>
                <inertia ixx="0.000003368" ixy="0.000000115" ixz="0" iyy="0.000001556" iyz="0" izz="0.000002863"/>
            </inertial>
        </link>
        <joint name="r_12rinkie0" type="revolute">
            <origin xyz="-0.0071 -0.0678 -0.01872" rpy="1.5708 1.5708 0"/>
            <parent link="palm_base_link"/>
            <child link="r_rinkie0"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.314" upper="2.23"/>
        </joint>
        <joint name="r_13rinkie1" type="revolute">
            <origin xyz="-0.0122 0.0381 0.0145" rpy="-1.5708558 0 1.5708"/>
            <parent link="r_rinkie0"/>
            <child link="r_rinkie1"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-1.047" upper="1.047"/>
        </joint>
        <joint name="r_14rinkie2" type="revolute">
            <origin xyz="0.015 0.0143 -0.013" rpy="1.5708 -1.5708 0"/>
            <parent link="r_rinkie1"/>
            <child link="r_rinkie2"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.506" upper="1.885"/>
        </joint>
        <joint name="r_15rinkie3" type="revolute">
            <origin xyz="0 -0.0361 0.0002" rpy="0 0 0"/>
            <parent link="r_rinkie2"/>
            <child link="r_rinkie3"/>
            <axis xyz="0 0 -1"/>
            <limit effort="0.95" velocity="8.48" lower="-0.366" upper="2.042"/>
        </joint>

    </xacro:macro>

    <xacro:macro name="leap_anchor">
        <!--  anchor  -->
        <link name="A_00"/>
        <link name="A_01"/>
        <link name="A_02"/>
        <link name="A_03"/>
        <link name="A_04"/>
        <link name="A_05"/>
        <link name="A_06"/>
        <link name="A_07"/>
        <link name="A_08"/>
        <link name="A_09"/>
        <link name="A_10"/>
        <link name="A_11"/>
        <link name="A_12"/>
        <link name="A_13"/>
        <link name="A_14"/>
        <link name="A_15"/>
        <link name="A_16"/>
        <link name="A_17"/>
        <link name="A_18"/>
        <link name="A_19"/>
        <link name="A_20"/>
        <link name="A_21"/>
            <!--  thumb  -->
        <joint name="joint_A_00" type="fixed">
            <child link="A_00"/>
            <parent link="r_thumb1"/>
            <origin xyz="0.01 0 -0.017" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_01" type="fixed">
            <child link="A_01"/>
            <parent link="r_thumb2"/>
            <origin xyz="0.01 0.0469 -0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_02" type="fixed">
            <child link="A_02"/>
            <parent link="r_thumb3"/>
            <origin xyz="-0.0111 -0.046 -0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_03" type="fixed">
            <child link="A_03"/>
            <parent link="r_thumb3"/>
            <origin xyz="-0.005 -0.0621 -0.0145" rpy="0 0 0"/>
        </joint>
        <!--  index  -->
        <joint name="joint_A_04" type="fixed">
            <child link="A_04"/>
            <parent link="r_index1"/>
            <origin xyz="0 0 -0.023" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_05" type="fixed">
            <child link="A_05"/>
            <parent link="r_index2"/>
            <origin xyz="-0.01 -0.018 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_06" type="fixed">
            <child link="A_06"/>
            <parent link="r_index3"/>
            <origin xyz="-0.011 -0.031 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_07" type="fixed">
            <child link="A_07"/>
            <parent link="r_index3"/>
            <origin xyz="-0.004 -0.0495 0.0145" rpy="0 0 0"/>
        </joint>
        <!--  mid  -->
        <joint name="joint_A_08" type="fixed">
            <child link="A_08"/>
            <parent link="r_middle1"/>
            <origin xyz="0 0 -0.023" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_09" type="fixed">
            <child link="A_09"/>
            <parent link="r_middle2"/>
            <origin xyz="-0.01 -0.018 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_10" type="fixed">
            <child link="A_10"/>
            <parent link="r_middle3"/>
            <origin xyz="-0.011 -0.031 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_11" type="fixed">
            <child link="A_11"/>
            <parent link="r_middle3"/>
            <origin xyz="-0.004 -0.0495 0.0145" rpy="0 0 0"/>
        </joint>
        <!--  ring  -->
        <joint name="joint_A_12" type="fixed">
            <child link="A_12"/>
            <parent link="r_rinkie1"/>
            <origin xyz="0 0 -0.023" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_13" type="fixed">
            <child link="A_13"/>
            <parent link="r_rinkie2"/>
            <origin xyz="-0.01 -0.018 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_14" type="fixed">
            <child link="A_14"/>
            <parent link="r_rinkie3"/>
            <origin xyz="-0.011 -0.031 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_15" type="fixed">
            <child link="A_15"/>
            <parent link="r_rinkie3"/>
            <origin xyz="-0.004 -0.0495 0.0145" rpy="0 0 0"/>
        </joint>
        <!--  pinkie  -->
        <joint name="joint_A_16" type="fixed">
            <child link="A_16"/>
            <parent link="r_rinkie1"/>
            <origin xyz="0 0 -0.023" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_17" type="fixed">
            <child link="A_17"/>
            <parent link="r_rinkie2"/>
            <origin xyz="-0.01 -0.018 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_18" type="fixed">
            <child link="A_18"/>
            <parent link="r_rinkie3"/>
            <origin xyz="-0.011 -0.031 0.0145" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_19" type="fixed">
            <child link="A_19"/>
            <parent link="r_rinkie3"/>
            <origin xyz="-0.004 -0.0495 0.0145" rpy="0 0 0"/>
        </joint>
        <!--  palm  -->
        <joint name="joint_A_20" type="fixed">
            <child link="A_20"/>
            <parent link="palm_base_link"/>
            <origin xyz="-0.036 0.01 -0.035" rpy="0 0 0"/>
        </joint>
        <joint name="joint_A_21" type="fixed">
            <child link="A_21"/>
            <parent link="palm_base_link"/>
            <origin xyz="-0.036 -0.081 -0.035" rpy="0 0 0"/>
        </joint>
    </xacro:macro>
</robot>